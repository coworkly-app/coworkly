<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–î–µ —î —Å–≤—ñ—Ç–ª–æ? ‚ö°</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'media',
        }
    </script>
    
    <style>
        body { transition: background-color 0.3s, color 0.3s; }
        .bg-texture-light { background-image: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%239C92AC' fill-opacity='0.12'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E"); }
        .bg-texture-dark { background-image: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='0.05'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E"); }
        .modal-enter { opacity: 0; transform: scale(0.95); }
        .modal-enter-active { opacity: 1; transform: scale(1); transition: all 0.2s; }
    </style>
    
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getAnalytics } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-analytics.js";
        import { getFirestore, collection, setDoc, getDocs, query, orderBy, serverTimestamp, updateDoc, doc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        // --- ‚ö†Ô∏è –í–°–¢–ê–í –°–Æ–î–ò –°–í–û–á –î–ê–ù–Ü FIREBASE ‚ö†Ô∏è ---
        const firebaseConfig = {
            apiKey: "AIzaSyB098Rx6AOCdkjX7ZgX6Zk42uNDv8PXbXc",
            authDomain: "coworkly-3d04d.firebaseapp.com",
            projectId: "coworkly-3d04d",
            storageBucket: "coworkly-3d04d.firebasestorage.app",
            messagingSenderId: "685280227506",
            appId: "1:685280227506:web:9e31da685783f7948159ab",
            measurementId: "G-XNH7HV87L4"
        };

        const app = initializeApp(firebaseConfig);
        const analytics = getAnalytics(app);
        const db = getFirestore(app);

        const cities = [
            "–ö–∏—ó–≤", "–•–∞—Ä–∫—ñ–≤", "–û–¥–µ—Å–∞", "–î–Ω—ñ–ø—Ä–æ", "–ó–∞–ø–æ—Ä—ñ–∂–∂—è", "–õ—å–≤—ñ–≤", "–ö—Ä–∏–≤–∏–π –†—ñ–≥", "–ú–∏–∫–æ–ª–∞—ó–≤", 
            "–í—ñ–Ω–Ω–∏—Ü—è", "–ü–æ–ª—Ç–∞–≤–∞", "–ß–µ—Ä–Ω—ñ–≥—ñ–≤", "–ß–µ—Ä–∫–∞—Å–∏", "–ñ–∏—Ç–æ–º–∏—Ä", "–°—É–º–∏", "–†—ñ–≤–Ω–µ", 
            "–Ü–≤–∞–Ω–æ-–§—Ä–∞–Ω–∫—ñ–≤—Å—å–∫", "–ö–∞–º'—è–Ω—Å—å–∫–µ", "–ö—Ä–æ–ø–∏–≤–Ω–∏—Ü—å–∫–∏–π", "–¢–µ—Ä–Ω–æ–ø—ñ–ª—å", "–õ—É—Ü—å–∫", 
            "–ë—ñ–ª–∞ –¶–µ—Ä–∫–≤–∞", "–ö—Ä–µ–º–µ–Ω—á—É–∫", "–ë—Ä–æ–≤–∞—Ä–∏", "–ü–∞–≤–ª–æ–≥—Ä–∞–¥", "–ú—É–∫–∞—á–µ–≤–æ", "–ö–æ–Ω–æ—Ç–æ–ø", "–£–º–∞–Ω—å", 
            "–û–ª–µ–∫—Å–∞–Ω–¥—Ä—ñ—è", "–î—Ä–æ–≥–æ–±–∏—á", "–ë–µ—Ä–¥–∏—á—ñ–≤", "–®–æ—Å—Ç–∫–∞", "–Ü–∑–º–∞—ó–ª", "–ù–æ–≤–æ–º–æ—Å–∫–æ–≤—Å—å–∫", 
            "–ö–æ–≤–µ–ª—å", "–ù—ñ–∂–∏–Ω", "–°–º—ñ–ª–∞", "–ö–∞–ª—É—à", "–ß–µ—Ä–≤–æ–Ω–æ–≥—Ä–∞–¥", "–ë–æ—Ä–∏—Å–ø—ñ–ª—å", "–ö–æ—Ä–æ—Å—Ç–µ–Ω—å", "–ö–æ–ª–æ–º–∏—è", "–Ü—Ä–ø—ñ–Ω—å"
        ].sort();

        const citySelects = ['searchCity', 'addCity'];
        citySelects.forEach(id => {
            const select = document.getElementById(id);
            if(select) {
                cities.forEach(city => {
                    const opt = document.createElement('option');
                    opt.value = city;
                    opt.textContent = city;
                    select.appendChild(opt);
                });
            }
        });

        // 1. –¢—Ä–∞–Ω—Å–ª—ñ—Ç–µ—Ä–∞—Ü—ñ—è
        function generateReadableId(city, name) {
            const map = {
                '–∞': 'a', '–±': 'b', '–≤': 'v', '–≥': 'h', '“ë': 'g', '–¥': 'd', '–µ': 'e', '—î': 'ye', '–∂': 'zh',
                '–∑': 'z', '–∏': 'y', '—ñ': 'i', '—ó': 'yi', '–π': 'y', '–∫': 'k', '–ª': 'l', '–º': 'm', '–Ω': 'n',
                '–æ': 'o', '–ø': 'p', '—Ä': 'r', '—Å': 's', '—Ç': 't', '—É': 'u', '—Ñ': 'f', '—Ö': 'kh', '—Ü': 'ts',
                '—á': 'ch', '—à': 'sh', '—â': 'shch', '—å': '', '—é': 'yu', '—è': 'ya', ' ': '-', '.': '', ',': ''
            };
            const text = `${city}-${name}`.toLowerCase();
            let result = '';
            for (let char of text) {
                result += map[char] || (/[a-z0-9-]/.test(char) ? char : '');
            }
            const random = Math.floor(Math.random() * 1000).toString();
            return `${result}-${random}`;
        }

        // 2. –ì–µ–æ–∫–æ–¥—É–≤–∞–Ω–Ω—è (OpenStreetMap)
        async function getCoordinatesFromAddress(city, address) {
            const query = `${address}, ${city}, Ukraine`;
            const url = `https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(query)}&limit=1`;
            try {
                const response = await fetch(url, { headers: { 'User-Agent': 'Coworkly-App' } });
                const data = await response.json();
                if (data && data.length > 0) {
                    return { lat: parseFloat(data[0].lat), lng: parseFloat(data[0].lon) };
                }
            } catch (e) { console.warn("Geocoding failed:", e); }
            return null;
        }

        // 3. –í—ñ–¥—Å—Ç–∞–Ω—å
        function getDistanceFromLatLonInKm(lat1, lon1, lat2, lon2) {
            const R = 6371; 
            const dLat = (lat2-lat1) * (Math.PI/180);
            const dLon = (lon2-lon1) * (Math.PI/180);
            const a = Math.sin(dLat/2) * Math.sin(dLat/2) +
                      Math.cos(lat1 * (Math.PI/180)) * Math.cos(lat2 * (Math.PI/180)) * Math.sin(dLon/2) * Math.sin(dLon/2);
            return R * (2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a)));
        }

        let userCoords = null;
        let addCoords = null; 
        let tempFormData = null;

        // 4. –õ–æ–∫–∞—Ü—ñ—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ (–¥–ª—è –ø–æ—à—É–∫—É)
        window.requestUserLocation = () => {
            const statusDiv = document.getElementById('geoStatus');
            if(statusDiv) statusDiv.innerHTML = '<span class="text-blue-500 animate-pulse">–í–∏–∑–Ω–∞—á–∞—î–º–æ –ª–æ–∫–∞—Ü—ñ—é...</span>';
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition((position) => {
                    userCoords = { lat: position.coords.latitude, lng: position.coords.longitude };
                    if(statusDiv) statusDiv.innerHTML = '<span class="text-green-600 font-semibold">‚úÖ –í–∞—à—É –ª–æ–∫–∞—Ü—ñ—é –∑–Ω–∞–π–¥–µ–Ω–æ</span>';
                    document.getElementById('searchCity').value = "";
                    loadLocations();
                }, (error) => {
                    userCoords = null;
                    if(statusDiv) statusDiv.innerHTML = '<span class="text-gray-500">üìç –ü–æ—à—É–∫ –∑–∞ –º—ñ—Å—Ç–æ–º (GPS –≤–∏–º–∫–Ω–µ–Ω–æ)</span>';
                    loadLocations();
                });
            } else { loadLocations(); }
        }

        // 5. –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Å–ø–∏—Å–∫—É
        async function loadLocations() {
            const listDiv = document.getElementById('locationsList');
            const cityFilter = document.getElementById('searchCity').value;
            if(listDiv) listDiv.innerHTML = '<p class="text-center dark:text-gray-400 mt-4">–û–Ω–æ–≤–ª–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö...</p>';
            
            try {
                const q = query(collection(db, "locations"), orderBy("updated_at", "desc"));
                const querySnapshot = await getDocs(q);
                let locations = [];
                
                querySnapshot.forEach((docSnap) => {
                    const data = docSnap.data();
                    let dist = (userCoords && data.lat && data.lng) ? getDistanceFromLatLonInKm(userCoords.lat, userCoords.lng, data.lat, data.lng) : null;
                    locations.push({ id: docSnap.id, ...data, distance: dist });
                });

                if (cityFilter) locations = locations.filter(l => l.city === cityFilter);

                if (userCoords) {
                    locations.sort((a, b) => {
                        const distA = a.distance !== null ? a.distance : 99999;
                        const distB = b.distance !== null ? b.distance : 99999;
                        return distA - distB;
                    });
                }

                if(listDiv) {
                    listDiv.innerHTML = '';
                    if (locations.length === 0) {
                        listDiv.innerHTML = `<div class="text-center p-8 border-2 border-dashed border-gray-300 dark:border-gray-700 rounded-xl mt-4 bg-white/50 dark:bg-gray-800/50"><h3 class="font-bold text-gray-700 dark:text-gray-300">–ü–æ–∫–∏ —â–æ –ø—É—Å—Ç–æ...</h3></div>`;
                        return;
                    }
                    locations.forEach((data) => {
                        const date = data.updated_at?.toDate().toLocaleString('uk-UA') || '–©–æ–π–Ω–æ';
                        let mapLink = data.lat && data.lng ? `https://www.google.com/maps/dir/?api=1&destination=${data.lat},${data.lng}` : `https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(data.city + ', ' + data.address)}`;
                        
                        const distBadge = data.distance 
                            ? `<span class="bg-blue-600 text-white px-2 py-0.5 rounded text-[10px] font-bold ml-2">üìç ~${data.distance.toFixed(1)} –∫–º</span>` 
                            : '<span class="bg-gray-200 text-gray-500 px-2 py-0.5 rounded text-[10px] font-bold ml-2">üåê –ù–µ–º–∞—î GPS</span>';
                        
                        const card = document.createElement('div');
                        card.className = "p-4 border border-gray-200 dark:border-gray-700 rounded-xl shadow-sm bg-white/90 dark:bg-gray-800/90 backdrop-blur-sm mb-4";
                        card.innerHTML = `
                            <div class="flex justify-between items-start mb-2">
                                <div><h3 class="font-bold text-lg dark:text-white inline-block">${data.name}</h3>${distBadge}</div>
                                <span class="text-[10px] uppercase text-gray-400 text-right min-w-[70px]">–û–Ω–æ–≤–ª–µ–Ω–æ:<br>${date}</span>
                            </div>
                            <p class="text-sm text-gray-600 dark:text-gray-400 mb-2">${data.city}, ${data.address}</p>
                            <div class="flex gap-2 mb-3">
                                <span class="${data.has_power ? 'bg-yellow-100 text-yellow-800' : 'bg-gray-100 text-gray-400'} px-2 py-1 rounded-lg text-xs font-bold">${data.has_power ? '‚ö° –Ñ —Å–≤—ñ—Ç–ª–æ' : 'üí§ –ù–µ–º–∞—î'}</span>
                                <span class="${data.has_internet ? 'bg-blue-100 text-blue-800' : 'bg-gray-100 text-gray-400'} px-2 py-1 rounded-lg text-xs font-bold">${data.has_internet ? 'üåê –Ñ —ñ–Ω–µ—Ç' : 'üö´ –ù–µ–º–∞—î'}</span>
                            </div>
                            ${data.description ? `<p class="text-sm italic text-gray-500 mb-3 border-l-2 pl-2 border-gray-300">${data.description}</p>` : ''}
                            <div class="flex gap-2">
                                <button onclick="window.updateStatus('${data.id}')" class="flex-1 py-2 text-blue-600 dark:text-blue-400 text-xs font-bold border border-blue-100 dark:border-blue-900/50 rounded-lg active:bg-blue-50">–¶–µ –∞–∫—Ç—É–∞–ª—å–Ω–æ ‚úÖ</button>
                                <a href="${mapLink}" target="_blank" class="flex-none px-4 py-2 bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300 rounded-lg text-xs font-bold flex items-center justify-center hover:bg-gray-200 transition">üó∫Ô∏è –ú–∞—Ä—à—Ä—É—Ç</a>
                            </div>
                        `;
                        listDiv.appendChild(card);
                    });
                }
            } catch (e) { console.error(e); }
        }

        // 6. –ü–Ü–î–ì–û–¢–û–í–ö–ê –î–û –ü–£–ë–õ–Ü–ö–ê–¶–Ü–á (–í–Ü–î–ö–†–ò–í–ê–Ñ –ú–û–î–ê–õ–ö–£)
        window.openConfirmation = async () => {
            const btn = document.getElementById('preSaveBtn');
            const name = document.getElementById('addName').value;
            const city = document.getElementById('addCity').value;
            const addr = document.getElementById('addAddress').value;
            const desc = document.getElementById('addDesc').value;
            const hasPower = document.getElementById('hasPower').checked;
            const hasInternet = document.getElementById('hasInternet').checked;

            if(!name || !addr) return alert("–ó–∞–ø–æ–≤–Ω—ñ—Ç—å –Ω–∞–∑–≤—É —Ç–∞ –∞–¥—Ä–µ—Å—É!");

            btn.disabled = true;
            btn.innerText = "–®—É–∫–∞—î–º–æ –∞–¥—Ä–µ—Å—É –Ω–∞ –∫–∞—Ä—Ç—ñ...";

            // –ê–≤—Ç–æ-–ø–æ—à—É–∫ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç –∑–∞ –∞–¥—Ä–µ—Å–æ—é
            let geoStatusText = "‚ùå –ù–µ –∑–Ω–∞–π–¥–µ–Ω–æ –Ω–∞ –∫–∞—Ä—Ç—ñ";
            let geoClass = "text-red-500";

            const autoCoords = await getCoordinatesFromAddress(city, addr);
            if (autoCoords) {
                addCoords = { ...autoCoords, method: 'auto' };
                geoStatusText = "‚úÖ –ó–Ω–∞–π–¥–µ–Ω–æ –Ω–∞ –∫–∞—Ä—Ç—ñ";
                geoClass = "text-green-600 font-bold";
            } else {
                addCoords = null;
            }

            // –ó–±–µ—Ä—ñ–≥–∞—î–º–æ –¥–∞–Ω—ñ –≤ —Ç–∏–º—á–∞—Å–æ–≤—É –∑–º—ñ–Ω–Ω—É
            tempFormData = { name, city, addr, desc, hasPower, hasInternet };

            // –ó–∞–ø–æ–≤–Ω—é—î–º–æ –º–æ–¥–∞–ª–∫—É
            document.getElementById('confName').innerText = name;
            document.getElementById('confAddress').innerText = `${city}, ${addr}`;
            document.getElementById('confGeo').innerHTML = `<span class="${geoClass}">${geoStatusText}</span>`;
            document.getElementById('confOpts').innerHTML = `
                ${hasPower ? '‚ö° –°–≤—ñ—Ç–ª–æ ' : ''} 
                ${hasInternet ? 'üåê –Ü–Ω—Ç–µ—Ä–Ω–µ—Ç' : ''}
            `;

            // –ü–æ–∫–∞–∑—É—î–º–æ –º–æ–¥–∞–ª–∫—É
            const modal = document.getElementById('confirmModal');
            modal.classList.remove('hidden');
            
            btn.disabled = false;
            btn.innerText = "–û–ü–£–ë–õ–Ü–ö–£–í–ê–¢–ò";
        };

        // 7. –§–Ü–ù–ê–õ–¨–ù–ï –ó–ë–ï–†–ï–ñ–ï–ù–ù–Ø
        window.finalSave = async () => {
            if (!tempFormData) return;
            const confirmBtn = document.getElementById('confirmBtn');
            confirmBtn.disabled = true;
            confirmBtn.innerText = "–í—ñ–¥–ø—Ä–∞–≤–∫–∞...";

            try {
                const customId = generateReadableId(tempFormData.city, tempFormData.name);
                const docData = {
                    name: tempFormData.name,
                    city: tempFormData.city,
                    address: tempFormData.addr,
                    has_power: tempFormData.hasPower,
                    has_internet: tempFormData.hasInternet,
                    description: tempFormData.desc,
                    updated_at: serverTimestamp()
                };
                
                if (addCoords) { 
                    docData.lat = addCoords.lat; 
                    docData.lng = addCoords.lng; 
                }
                
                await setDoc(doc(db, "locations", customId), docData);
                location.reload(); 
            } catch (error) { 
                alert("–ü–æ–º–∏–ª–∫–∞: " + error.message); 
                confirmBtn.disabled = false; 
                confirmBtn.innerText = "–í—Å–µ –≤—ñ—Ä–Ω–æ, –ø—É–±–ª—ñ–∫—É—î–º–æ";
            }
        };

        window.closeModal = () => {
            document.getElementById('confirmModal').classList.add('hidden');
        };

        window.updateStatus = async (id) => {
            await updateDoc(doc(db, "locations", id), { updated_at: serverTimestamp() });
            loadLocations();
        };

        window.loadLocations = loadLocations;
        window.requestUserLocation = requestUserLocation;
    </script>
</head>
<body class="bg-gray-50 dark:bg-gray-900 bg-texture-light dark:bg-texture-dark min-h-screen font-sans text-gray-900 dark:text-gray-100">
    <nav class="bg-blue-600 dark:bg-blue-800 text-white p-4 shadow-lg sticky top-0 z-20">
        <h1 class="text-xl font-black text-center">–î–ï –Ñ –°–í–Ü–¢–õ–û? ‚ö°</h1>
    </nav>
    <div class="max-w-md mx-auto p-4">
        <div class="flex mb-6 bg-white dark:bg-gray-800 rounded-xl p-1 shadow-inner border border-gray-100 dark:border-gray-700">
            <button onclick="showTab('find')" id="tabFind" class="flex-1 py-2.5 rounded-lg bg-blue-600 text-white font-bold transition-all shadow-md">–ó–Ω–∞–π—Ç–∏</button>
            <button onclick="showTab('add')" id="tabAdd" class="flex-1 py-2.5 rounded-lg text-gray-500 font-bold">–î–æ–¥–∞—Ç–∏</button>
        </div>
        
        <div id="sectionFind" class="space-y-4">
            <div class="bg-white/90 dark:bg-gray-800/90 p-4 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700">
                <div class="flex gap-2 mb-2">
                    <select id="searchCity" onchange="window.loadLocations()" class="flex-1 p-3 bg-gray-50 dark:bg-gray-700 border border-gray-200 rounded-xl outline-none dark:text-white">
                        <option value="" disabled selected>–û–±–µ—Ä—ñ—Ç—å –º—ñ—Å—Ç–æ...</option>
                    </select>
                    <button onclick="window.requestUserLocation()" class="bg-blue-100 text-blue-600 dark:bg-blue-900 p-3 rounded-xl border border-blue-200">üìç</button>
                </div>
                <div id="geoStatus" class="text-[10px] text-center h-4"></div>
            </div>
            <div id="locationsList"></div>
        </div>

        <div id="sectionAdd" class="hidden bg-white/90 dark:bg-gray-800/90 p-5 border border-gray-200 dark:border-gray-700 rounded-2xl shadow-xl">
            <h2 class="text-xl font-bold mb-5 text-center">–î–æ–¥–∞—Ç–∏ –∫–æ–≤–æ—Ä–∫—ñ–Ω–≥</h2>
            <div class="space-y-4">
                <input type="text" id="addName" placeholder="–ù–∞–∑–≤–∞ –∑–∞–∫–ª–∞–¥—É" class="w-full p-3 bg-gray-50 dark:bg-gray-700 border border-gray-200 rounded-xl outline-none dark:text-white">
                <select id="addCity" class="w-full p-3 bg-gray-50 dark:bg-gray-700 border border-gray-200 rounded-xl dark:text-white"></select>
                <input type="text" id="addAddress" placeholder="–ê–¥—Ä–µ—Å–∞ (–Ω–∞–ø—Ä. –≤—É–ª. –°–æ–±–æ—Ä–Ω–∞ 5)" class="w-full p-3 bg-gray-50 dark:bg-gray-700 border border-gray-200 rounded-xl dark:text-white">
                
                <div class="flex gap-4 py-2">
                    <label class="flex items-center gap-2 cursor-pointer"><input type="checkbox" id="hasPower" class="w-5 h-5 rounded text-yellow-500"><span>–°–≤—ñ—Ç–ª–æ</span></label>
                    <label class="flex items-center gap-2 cursor-pointer"><input type="checkbox" id="hasInternet" class="w-5 h-5 rounded text-blue-500"><span>–Ü–Ω–µ—Ç</span></label>
                </div>
                <textarea id="addDesc" rows="2" placeholder="–£–º–æ–≤–∏ (—Ü—ñ–Ω–∞, –ø–∞—Ä–æ–ª—å –Ω–∞ —ñ–Ω–µ—Ç —Ç–æ—â–æ)" class="w-full p-3 bg-gray-50 dark:bg-gray-700 border border-gray-200 rounded-xl outline-none dark:text-white"></textarea>
                <button id="preSaveBtn" onclick="window.openConfirmation()" class="w-full bg-green-600 text-white py-4 rounded-xl font-black text-lg shadow-lg">–û–ü–£–ë–õ–Ü–ö–£–í–ê–¢–ò</button>
            </div>
        </div>
    </div>

    <div id="confirmModal" class="hidden fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4 backdrop-blur-sm modal-enter-active">
        <div class="bg-white dark:bg-gray-800 rounded-2xl p-6 max-w-sm w-full shadow-2xl border border-gray-200 dark:border-gray-700">
            <h3 class="text-xl font-bold mb-4 text-center dark:text-white">–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –¥–∞–Ω—ñ</h3>
            
            <div class="space-y-3 text-sm mb-6">
                <div class="bg-gray-50 dark:bg-gray-700/50 p-3 rounded-xl">
                    <p class="text-xs text-gray-500 dark:text-gray-400">–ù–∞–∑–≤–∞:</p>
                    <p class="font-bold text-lg dark:text-white" id="confName"></p>
                </div>
                <div>
                    <p class="text-xs text-gray-500 dark:text-gray-400">–ê–¥—Ä–µ—Å–∞:</p>
                    <p class="font-medium dark:text-gray-200" id="confAddress"></p>
                </div>
                <div>
                    <p class="text-xs text-gray-500 dark:text-gray-400">–ì–µ–æ–ª–æ–∫–∞—Ü—ñ—è:</p>
                    <p class="font-medium" id="confGeo"></p>
                </div>
                <div>
                    <p class="text-xs text-gray-500 dark:text-gray-400">–û–ø—Ü—ñ—ó:</p>
                    <p class="font-medium dark:text-gray-200" id="confOpts"></p>
                </div>
            </div>

            <div class="flex gap-3">
                <button onclick="window.closeModal()" class="flex-1 py-3 bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300 font-bold rounded-xl">–í—ñ–¥–º—ñ–Ω–∞</button>
                <button id="confirmBtn" onclick="window.finalSave()" class="flex-1 py-3 bg-green-600 text-white font-bold rounded-xl shadow-lg">–í—Å–µ –≤—ñ—Ä–Ω–æ</button>
            </div>
        </div>
    </div>

    <script>
        function showTab(tab) {
            const find = document.getElementById('sectionFind'), add = document.getElementById('sectionAdd');
            const tF = document.getElementById('tabFind'), tA = document.getElementById('tabAdd');
            if (tab === 'find') {
                find.classList.remove('hidden'); add.classList.add('hidden');
                tF.className = "flex-1 py-2.5 rounded-lg bg-blue-600 text-white font-bold shadow-md";
                tA.className = "flex-1 py-2.5 rounded-lg text-gray-500 font-bold";
                window.requestUserLocation();
            } else {
                find.classList.add('hidden'); add.classList.remove('hidden');
                tA.className = "flex-1 py-2.5 rounded-lg bg-green-600 text-white font-bold shadow-md";
                tF.className = "flex-1 py-2.5 rounded-lg text-gray-500 font-bold";
            }
        }
    </script>
</body>
</html>
